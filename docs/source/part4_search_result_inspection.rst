Part 4: Search Result Inspection
=================================

Overview
--------

In this part, you will explore the output files generated by the Sipros search and understand how to interpret the results. You will learn how to locate peptide-spectrum matches (PSMs), peptides, and protein identifications, as well as how to interpret quantification data.

Task 1: Understand the Output Directory Structure
-------------------------------------------------

**Step 1: Navigate to the Output Directory**

Move to the `sipros_output` directory where the search results are stored:

.. code-block:: bash

   session_path="/dev/shm"
   cd "${session_path}/mp_practical/sipros_output"

**Step 2: List the Contents of the Output Directory**

List all files in the `sipros_output` directory:

.. hint::

    .. toggle::

      .. code-block:: bash

         ls -lSh

.. hint:: 
   
   You should see the following files:

   .. code-block:: text

      .
      ├── converge.cfg
      ├── E4.sample1.pep.txt
      ├── E4.sample1.pro2pep.txt
      ├── E4.sample1.pro2psm.txt
      ├── E4.sample1.pro.txt
      ├── E4.sample1.psm.txt
      ├── E4.sample1.Spe2Pep.txt
      └── E4.sample1.tab

**Questions**

- **Q1:** What types of files are present in the output directory?
- **Q2:** Based on the file extensions and names, what do you think each file contains?

.. hint::

    .. toggle::

      - Files ending with `.psm.txt` likely contain PSMs.
      - Files ending with `.pep.txt` probably contain peptide identifications.
      - Files ending with `.pro.txt` are expected to contain protein identifications.

Task 2: Explore Peptide-Spectrum Matches (PSMs)
-----------------------------------------------

**Step 1: Inspect the PSM File**

Open the PSM file to explore its contents:

.. code-block:: bash

   less -RS "E4.sample1.psm.txt"

**Step 2: Understand the PSM File Format**

- **Q3:** What information is provided for each PSM?
- **Q4:** Which columns are most important for assessing the quality of a PSM?
- **Q5:** How many PSMs were identified?
- **Q6:** How does the number of PSMs relate to the number of spectra in your MS2 file?

Task 3: Examine Peptide Identifications
---------------------------------------

**Step 1: Inspect the Peptide File**

Open the peptide file:

.. code-block:: bash

   less -RS "E4.sample1.pep.txt"

**Step 2: Understand the Peptide File Format**

- **Q7:** What information is provided for each peptide?
- **Q8:** How are peptides quantified in this file?
- **Q9:** How many unique peptides were identified?
- **Q10:** What might be the reason for peptides appearing multiple times in the PSM file but only once in the peptide file?

Task 4: Analyze Protein Identifications
---------------------------------------

**Step 1: Inspect the Protein File**

Open the protein file:

.. code-block:: bash

   less -RS "E4.sample1.pro.txt"

**Step 2: Understand the Protein File Format**

- **Q11:** What information is provided for each protein?
- **Q12:** How is protein quantification represented?
- **Q13:** Which proteins are the most abundant?
- **Q14:** Do these proteins make sense biologically in the context of your sample?
- **Q15:** How can you obtain more information about a specific protein?
- **Q16:** Are there proteins with high peptide counts but low spectral counts? What might this indicate?


Task 6: Explore Additional Output Files (Optional)
---------------------------------------

**Step 1: Inspect the `pro2pep` and `pro2psm` Files**

Open these files to understand how peptides and PSMs map to proteins:

.. code-block:: bash

   less -RS "E4.sample1.pro2pep.txt"
   less -RS "E4.sample1.pro2psm.txt"

**Questions**

- **Q20:** How are peptides assigned to proteins in these files?
- **Q21:** Why might a peptide be assigned to multiple proteins?

Task 7: Interpret the FDR and Statistical Results
-------------------------------------------------

**Step 1: Review Statistical Results in Protein File**

At the beginning of the `E4.sample1.pro.txt` file, locate the `[Statistical_Results]` section.

**Questions**

- **Q24:** What are the `Target_Proteins_Before_Filtering` and `After_Filtering` values?
- **Q25:** What is the final `Protein_FDR` reported?
- **Q26:** Why is the protein FDR value so low/high?

Task 8: Summarize Your Findings
-------------------------------

**Step 1: Reflect on the Results**

- **Q28:** What are the key findings from your exploration of the search results?
- **Q29:** How confident are you in the protein identifications, and why?

**Notes**

- Understanding the relationship between PSMs, peptides, and proteins is crucial for interpreting proteomics data.
- Always consider the FDR and statistical validity of your identifications.

**Congratulations!**

You have successfully explored and interpreted the search results from your metaproteomics analysis.
